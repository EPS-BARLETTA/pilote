<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PILOTE – Tour de contrôle</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body data-page="parent">
  <main class="container dashboard">
    <header class="card page-hero">
      <p class="eyebrow">Espace parent</p>
      <h1>Tour de contrôle</h1>
      <p>Des repères concrets pour co-réguler sans culpabiliser.</p>

      <nav class="row" aria-label="Navigation">
        <a class="btn ghost" href="index.html">← Accueil</a>
        <a class="btn ghost" href="bilan.html">Temps de compréhension</a>
        <button class="btn ghost" data-action="lock-parent" type="button">Verrouiller</button>
      </nav>
    </header>

    <section class="card crisis-block">
      <h2>Mode crise (30 secondes)</h2>
      <p class="micro-copy">Objectif : sécurité + baisse du moteur. Pas de négociation pendant la montée.</p>

      <div class="grid">
        <article class="card nested-card">
          <p class="eyebrow">Phrase à dire</p>
          <p id="crisisPhrase" class="crisis-text">« Je vois que c'est dur. On met tout en pause. Je suis là. »</p>
          <button class="btn ghost" id="crisisPhraseBtn" type="button">Autre phrase</button>
        </article>

        <article class="card nested-card">
          <p class="eyebrow">Action immédiate</p>
          <p id="crisisDo" class="crisis-text"></p>
          <p class="micro-copy">Une seule consigne courte. Voix basse. Stimulations ↓</p>
        </article>

        <article class="card nested-card">
          <p class="eyebrow">Après la pause</p>
          <p id="crisisAfter" class="crisis-text"></p>
          <p class="micro-copy">Réparer doucement → puis revenir au petit pas.</p>
        </article>
      </div>
    </section>

    <section class="card lock-banner" id="parentLockBanner">
      <h2>Déverrouiller vos réglages</h2>
      <p>Ce code empêche simplement les petites mains de modifier l'outil.</p>
      <form id="parentUnlockForm" class="pin-form">
        <label for="parentPinInput">Votre code</label>
        <input id="parentPinInput" type="password" inputmode="numeric" maxlength="6" required />
        <button type="submit">Ouvrir</button>
      </form>
    </section>

    <section class="card" id="pinSetupPanel">
      <h2>Définir votre code PIN</h2>
      <p class="small">Choisissez un code (4 à 6 chiffres) pour protéger le cockpit enfant.</p>
      <form id="pinSetupForm" class="pin-form">
        <label for="pinSetupInput">Nouveau code</label>
        <input id="pinSetupInput" type="password" inputmode="numeric" minlength="4" maxlength="6" required />
        <button type="submit">Enregistrer</button>
      </form>
    </section>

    <div class="grid lockable" id="parentContent">
      <article class="card span-2">
        <div class="card-head">
          <h2>Objectifs de la semaine</h2>
          <div class="primary-badge" id="primaryObjectiveBadge">Aucun objectif principal</div>
        </div>
        <p class="micro-copy">1 objectif principal, 2 optionnels maximum. On cherche un progrès, pas la perfection.</p>
        <div class="objective-choices" id="objectiveChoices"></div>
      </article>

      <article class="card span-2">
        <h2>Scripts prêts à dire</h2>
        <div class="scripts" id="scriptList"></div>
      </article>

      <article class="card">
        <h2>Routines</h2>
        <form id="routineForm" class="stack-form">
          <label>Routine du matin</label>
          <textarea data-routine="morning" rows="3" placeholder="3 étapes maximum."></textarea>

          <label>Routine des devoirs</label>
          <textarea data-routine="homework" rows="3"></textarea>

          <label>Routine du soir</label>
          <textarea data-routine="evening" rows="3"></textarea>

          <hr />

          <h3>Plan B (si ça monte)</h3>
          <p class="micro-copy">Une alternative simple, déjà validée, pour éviter l’escalade.</p>

          <label>Plan B matin</label>
          <textarea data-routine="planBMorning" rows="2" placeholder="Ex : 1 étape + pause + retour"></textarea>

          <label>Plan B devoirs</label>
          <textarea data-routine="planBHomework" rows="2"></textarea>

          <label>Plan B soir</label>
          <textarea data-routine="planBEvening" rows="2"></textarea>

          <button type="submit">Sauvegarder</button>
        </form>
      </article>
      <article class="card">
        <h2>Stratégies proposées</h2>
        <form id="strategyForm" class="stack-form">
          <p class="micro-copy">Entre 3 et 5 idées stables. Elles apparaissent telles quelles pour l'enfant.</p>
          <div class="field-group" id="strategyFields"></div>
          <button type="submit">Enregistrer</button>
        </form>
      </article>

      <article class="card">
        <h2>Déclencheurs fréquents</h2>
        <form id="triggerForm" class="stack-form">
          <div class="trigger-options" id="triggerOptions"></div>

          <label for="triggerOtherInput">Autres déclencheurs</label>
          <textarea id="triggerOtherInput" rows="3" placeholder="Compléter si besoin."></textarea>

          <button type="submit">Mettre à jour</button>
        </form>
      </article>

      <article class="card">
        <h2>Récompenses</h2>
        <p class="micro-copy">Les récompenses encouragent l'effort. Jamais négociées en pleine crise.</p>
        <form id="rewardForm" class="stack-form">
          <label>Immédiates</label>
          <textarea data-reward="immediate" rows="3" placeholder="Moment câlin, puzzle, jeu calme..."></textarea>

          <label>Programmées</label>
          <textarea data-reward="planned" rows="3" placeholder="Balade, vélo, cinéma..."></textarea>

          <label for="plannedNextInput">Prochaine sortie</label>
          <input id="plannedNextInput" type="text" placeholder="Ex : Samedi 15h – Vélo" />

          <label>Symboliques</label>
          <textarea data-reward="symbolic" rows="3" placeholder="Badges, messages..."></textarea>

          <button type="submit">Rendre visible côté enfant</button>
        </form>
      </article>
    </div>
  </main>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>
  <script src="app.js" defer></script>
</body>
</html>
